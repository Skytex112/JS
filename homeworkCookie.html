<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Палітра кольорів</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f0f0f0;
      padding: 30px;
      max-width: 800px;
      margin: auto;
    }

    h1, h2 {
      color: #333;
      text-align: center;
    }

    #palette {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .color-box {
      width: 120px;
      height: 120px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #fff;
      font-size: 16px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-bottom: 15px;
      font-weight: 500;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }

    button {
      background-color: #0078D7;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background-color: #005fa3;
    }

    .error {
      color: red;
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Моя палітра кольорів</h1>
  <div id="palette"></div>

  <h2>Додати новий колір</h2>
  <form id="colorForm">
    <label>Назва кольору:
      <input type="text" id="colorName" required />
    </label>
    <label>Тип кольору:
      <select id="colorType">
        <option value="RGB">RGB</option>
        <option value="RGBA">RGBA</option>
        <option value="HEX">HEX</option>
      </select>
    </label>
    <label>Код кольору:
      <input type="text" id="colorCode" required />
    </label>
    <button type="submit">Додати</button>
    <div class="error" id="errorMsg"></div>
  </form>

  <script>
    const paletteDiv = document.getElementById('palette');
    const form = document.getElementById('colorForm');
    const errorMsg = document.getElementById('errorMsg');

    function getColors() {
      const cookie = document.cookie.split('; ').find(row => row.startsWith('colors='));
      return cookie ? JSON.parse(decodeURIComponent(cookie.split('=')[1])) : [];
    }

    function saveColors(colors) {
      const expires = new Date(Date.now() + 3 * 60 * 60 * 1000).toUTCString();
      document.cookie = `colors=${encodeURIComponent(JSON.stringify(colors))}; expires=${expires}; path=/`;
    }

    function renderPalette() {
      paletteDiv.innerHTML = '';
      const colors = getColors();
      colors.forEach(c => {
        const box = document.createElement('div');
        box.className = 'color-box';
        box.style.backgroundColor = c.code;
        box.textContent = c.name;
        paletteDiv.appendChild(box);
      });
    }

    function validateColor(name, type, code, existingNames) {
      if (!/^[a-zA-Zа-яА-ЯіІїЇєЄ]+$/.test(name)) return 'Назва має містити лише літери';
      if (existingNames.includes(name.toLowerCase())) return 'Назва вже існує';
      if (type === 'RGB' && !/^(\d{1,3}),(\d{1,3}),(\d{1,3})$/.test(code)) return 'Невірний формат RGB';
      if (type === 'RGBA' && !/^(\d{1,3}),(\d{1,3}),(\d{1,3}),(0(\.\d+)?|1(\.0+)?)$/.test(code)) return 'Невірний формат RGBA';
      if (type === 'HEX' && !/^#([0-9A-Fa-f]{6})$/.test(code)) return 'Невірний формат HEX';
      return '';
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('colorName').value.trim();
      const type = document.getElementById('colorType').value;
      const code = document.getElementById('colorCode').value.trim();
      const colors = getColors();
      const names = colors.map(c => c.name.toLowerCase());

      const error = validateColor(name, type, code, names);
      if (error) {
        errorMsg.textContent = error;
        return;
      }

      const colorCode = type === 'RGB' ? `rgb(${code})` :
                        type === 'RGBA' ? `rgba(${code})` : code;

      colors.push({ name, code: colorCode });
      saveColors(colors);
      renderPalette();
      form.reset();
      errorMsg.textContent = '';
    });

    renderPalette();
  </script>
</body>
</html>